<div class="modal fade modal-load <?=$jatbi->ajax('load')?>" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg pt-standalone">
        <div class="modal-content rounded-5 border-0 shadow-lg">
            <div class="d-flex w-100 justify-content-end align-items-center position-relative">
                <button type="button"
                    class="btn btn-eclo position-absolute z-1 rounded-circle d-flex align-items-center justify-content-center width height top right"
                    data-bs-dismiss="modal" aria-label="Close"
                    style="--width:50px;--height:50px;--top:-5px;--right:-5px">
                    <i class="ti ti-x fs-4"></i>
                </button>
            </div>
            <div class="modal-body">
                <h5 class="fw-bold text-body mb-3">
                    <?=$title?>
                </h5>
                <form method="POST" action="<?=$_SERVER['REQUEST_URI']?>" data-reload="true">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">

                                <?=$app->component('input', [
                                    "name" => 'code',
                                    "placeholder" => $jatbi->lang("Số quyết định"),
                                    "value" => $data['code'] ?? '',
                                    "required" => 'true',
                                ])?>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">

                                <?php if (isset($data['id']) && $data['id']): ?>
                                <?php // Chế độ Sửa: Vô hiệu hóa ô chọn và thêm input ẩn ?>
                                <?=$app->component('select', [
                                        "name" => 'personnels_disabled', 
                                        "options" => $personnels,
                                        "selected" => $data['contract'] ?? '',
                                        "placeholder" => $jatbi->lang("Nhân viên"),
                                        "required" => 'true',
                                        "disabled" => true,
                                    ])?>
                                <input type="hidden" name="personnels" value="<?=$data['contract'] ?? ''?>" />
                                <?php else: ?>
                                <?php // Chế độ Thêm: Giữ nguyên ô chọn ?>
                                <?=$app->component('select', [
                                        "name" => 'personnels',
                                        "options" => $personnels,
                                        "selected" => $data['contract'] ?? '',
                                        "placeholder" => $jatbi->lang("Nhân viên"),
                                        "required" => 'true',
                                    ])?>
                                <?php endif; ?>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">

                                <?=$app->component('input', [
                                    "type" => "date",
                                    "name" => 'date',
                                    "placeholder"=> $jatbi->lang("Ngày nghỉ"),
                                    "value" => $data['date'] ?? date("Y-m-d"),
                                    "required" => 'true',
                                ])?>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">

                                <?=$app->component('input', [
                                    "type" => "date",
                                    "name" => 'date_poster',
                                    "placeholder"=> $jatbi->lang("Ngày xuất quyết định"),
                                    "value" => $data['date_poster'] ?? date("Y-m-d"),
                                    "required" => 'true',
                                ])?>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">

                                <?=$app->component('select', [
                                    "name" => 'content',
                                    "placeholder" => $jatbi->lang("Chọn lý do"),
                                    "selected" => $data['content'] ?? 'Đơn phương chấm dứt hợp đồng',
                                    "required" => 'true',
                                    "options" => [
                                        ['value' => 'Đơn phương chấm dứt hợp đồng', 'text' => $jatbi->lang('Đơn phương chấm dứt hợp đồng')],
                                        ['value' => 'Thỏa thuận chấm dứt hợp đồng', 'text' => $jatbi->lang('Thỏa thuận chấm dứt hợp đồng')]
                                    ]
                                ])?>

                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">
                                <?=$app->component('select', [
                                    "name" => 'off',
                                    "placeholder" => $jatbi->lang("Tình trạng đơn"),
                                    "selected" => $data['off'] ?? '1',
                                    "required" => 'true',
                                    "options" => [
                                        ['value' => '1', 'text' => $jatbi->lang('Không có đơn nghỉ')],
                                        ['value' => '2', 'text' => $jatbi->lang('Có đơn nghỉ')]
                                    ]
                                ])?>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="mb-3">

                                <?=$app->component('textarea', [
                                    "name" => 'notes',
                                    "placeholder" => $jatbi->lang("Ghi chú"),
                                    "value" => $data['notes'] ?? '',
                                    "rows" => 4,
                                ])?>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <button type="submit" class="btn btn-eclo w-100 py-3 rounded-pill fw-bold"
                                data-action="submit" data-alert="true"
                                data-load="this"><?=$jatbi->lang("Hoàn thành")?></button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>